{
    "manifests": {
        "bauer-kirch/eap-pack": {
            "manifest": {
                "gitignore": [
                    "/.idea"
                ],
                "copy-from-recipe": {
                    ".gitlab-ci/": ".gitlab-ci/",
                    "docker/": "docker/",
                    "migrations/": "migrations/",
                    "phpstan.neon": "phpstan.neon",
                    "README.md": "README.md"
                }
            },
            "files": {
                ".gitlab-ci/php.yml": {
                    "contents": [
                        "variables:",
                        "  PHP_IMAGE: \"gitlab.lan.bauer-kirch.de:5001/eap/php/docker/php:php-8.1\"",
                        "  SYMFONY_PHPUNIT_DIR: \"vendor/bin/.phpunit\"",
                        "",
                        "setup_php:",
                        "  stage: setup",
                        "  tags:",
                        "    - docker",
                        "  image: $PHP_IMAGE",
                        "  script:",
                        "    - time composer install",
                        "  cache:",
                        "    key:",
                        "      files:",
                        "        - composer.lock",
                        "    paths:",
                        "      - vendor",
                        "  artifacts:",
                        "    expire_in: 30m",
                        "    paths:",
                        "      - vendor",
                        "",
                        "linting_php:",
                        "  stage: test",
                        "  tags:",
                        "    - docker",
                        "  image: $PHP_IMAGE",
                        "  script:",
                        "    - time vendor/bin/phpstan analyse -c phpstan.neon",
                        "",
                        "linting_twig:",
                        "  stage: test",
                        "  tags:",
                        "    - docker",
                        "  image: $PHP_IMAGE",
                        "  script:",
                        "    - time php bin/console lint:twig templates",
                        "",
                        "unit_tests_php:",
                        "  stage: test",
                        "  tags:",
                        "    - docker",
                        "  image: $PHP_IMAGE",
                        "  script:",
                        "    - time php bin/phpunit --log-junit phpunit-log.xml",
                        "  artifacts:",
                        "    when: always",
                        "    paths:",
                        "      - phpunit-log.xml",
                        "    reports:",
                        "      junit: phpunit-log.xml",
                        "",
                        "audit_depdash:",
                        "  stage: audit",
                        "  rules:",
                        "    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH",
                        "  tags:",
                        "    - depdash",
                        "  script:",
                        "    - /opt/bauer-kirch/depdash-composer-client/bin/console composer:report --gitlab",
                        "    - /opt/bauer-kirch/depdash-composer-client/bin/console composer:security-report",
                        "  allow_failure: true",
                        ""
                    ],
                    "executable": false
                },
                "README.md": {
                    "contents": [
                        "# Bauer + Kirch EAP Application",
                        "",
                        "This project is based on the EAP PHP Stack.",
                        "",
                        "- [Prerequisites](https://eap.pages.lan.bauer-kirch.de/php/docs/guide/env-prerequisites.html)",
                        "- [Documentation](https://eap.pages.lan.bauer-kirch.de/php/docs/)",
                        "",
                        "## Start application",
                        "```bash",
                        "docker/mkcert # only needed on first start",
                        "docker-compose up -d",
                        "```",
                        "",
                        "After all containers are started successfully, you can access your awesome app in the browser:",
                        "- Application: [https://localhost/](https://localhost/)",
                        "- Mails: [https://localhost/mailhog/](https://localhost/mailhog/)",
                        "- Database: [https://localhost/adminer](https://localhost/adminer)",
                        ""
                    ],
                    "executable": false
                },
                "docker/console": {
                    "contents": [
                        "#!/usr/bin/env bash",
                        "",
                        "docker-compose exec php bin/console \"$@\""
                    ],
                    "executable": true
                },
                "docker/phpstan": {
                    "contents": [
                        "#!/usr/bin/env bash",
                        "",
                        "docker-compose exec -T php vendor/bin/phpstan analyse -c phpstan.neon"
                    ],
                    "executable": true
                },
                "docker/phpunit": {
                    "contents": [
                        "#!/usr/bin/env bash",
                        "",
                        "docker-compose exec -T php php bin/phpunit"
                    ],
                    "executable": true
                },
                "migrations/VersionSetupSymfonyMessenger.php": {
                    "contents": [
                        "<?php",
                        "",
                        "declare(strict_types=1);",
                        "",
                        "namespace DoctrineMigrations;",
                        "",
                        "use Doctrine\\DBAL\\Schema\\Schema;",
                        "use Doctrine\\Migrations\\AbstractMigration;",
                        "",
                        "final class VersionSetupSymfonyMessenger extends AbstractMigration",
                        "{",
                        "    public function getDescription(): string",
                        "    {",
                        "        return 'Setup symfony messenger';",
                        "    }",
                        "",
                        "    public function up(Schema $schema): void",
                        "    {",
                        "        $this->addSql('CREATE TABLE messenger_messages (id BIGINT AUTO_INCREMENT NOT NULL, body LONGTEXT NOT NULL, headers LONGTEXT NOT NULL, queue_name VARCHAR(190) NOT NULL, created_at DATETIME NOT NULL, available_at DATETIME NOT NULL, delivered_at DATETIME DEFAULT NULL, INDEX IDX_75EA56E0FB7336F0 (queue_name), INDEX IDX_75EA56E0E3BD61CE (available_at), INDEX IDX_75EA56E016BA31DB (delivered_at), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE `utf8_unicode_ci` ENGINE = InnoDB');",
                        "    }",
                        "",
                        "    public function down(Schema $schema): void",
                        "    {",
                        "        $this->addSql('DROP TABLE messenger_messages');",
                        "    }",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "phpstan.neon": {
                    "contents": [
                        "includes:",
                        "    - vendor/phpstan/phpstan-deprecation-rules/rules.neon",
                        "    - vendor/phpstan/phpstan-phpunit/extension.neon",
                        "    - vendor/phpstan/phpstan-phpunit/rules.neon",
                        "    - vendor/phpstan/phpstan-strict-rules/rules.neon",
                        "    - vendor/phpstan/phpstan-symfony/rules.neon",
                        "    - vendor/phpstan/phpstan-symfony/extension.neon",
                        "",
                        "",
                        "parameters:",
                        "    parallel:",
                        "        processTimeout: 3000.0",
                        "    level: max",
                        "    paths:",
                        "        - src",
                        "        - tests",
                        "    excludePaths:",
                        "        - tests/bootstrap.php",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "c905bfd428940b8eac72796df650798c31554940"
        }
    }
}
