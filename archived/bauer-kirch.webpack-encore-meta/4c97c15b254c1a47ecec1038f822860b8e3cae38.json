{
    "manifests": {
        "bauer-kirch/webpack-encore-meta": {
            "manifest": {
                "gitignore": [
                    "/public/build",
                    "/public/webpack-dev"
                ],
                "copy-from-recipe": {
                    ".gitlab-ci/": ".gitlab-ci/",
                    "assets/": "assets/",
                    "config/": "%CONFIG_DIR%/",
                    "docker/": "docker/",
                    "package.json": "package.json",
                    "webpack.config.js": "webpack.config.js"
                },
                "docker-compose": {
                    "docker-compose.yml": {
                        "services": [
                            "webpack:",
                            "  image: 'git.bauer-kirch.de:5001/eap/php/docker-aux/webpack:latest'",
                            "  volumes:",
                            "    - ./:/var/www/app/:cached",
                            "    - npm-cache:/root/.npm:cached"
                        ],
                        "volumes": [
                            "npm-cache:"
                        ]
                    }
                }
            },
            "files": {
                ".gitlab-ci/webpack-encore.yml": {
                    "contents": [
                        "variables:",
                        "  NODE_IMAGE: \"git.bauer-kirch.de:5001/eap/php/docker-aux/webpack:latest\"",
                        "",
                        "build_npm:",
                        "  stage: build",
                        "  tags:",
                        "    - docker",
                        "  image: $NODE_IMAGE",
                        "  script:",
                        "    - time npm install",
                        "    - time npm run build",
                        "  artifacts:",
                        "    paths:",
                        "      - public/build",
                        "  only:",
                        "    - schedules",
                        ""
                    ],
                    "executable": false
                },
                "assets/favicon/.gitkeep": {
                    "contents": [
                        ""
                    ],
                    "executable": false
                },
                "assets/images/.gitkeep": {
                    "contents": [
                        ""
                    ],
                    "executable": false
                },
                "config/packages/webpack_encore.yaml": {
                    "contents": [
                        "webpack_encore:",
                        "    # The path where Encore is building the assets - i.e. Encore.setOutputPath()",
                        "    output_path: '%kernel.project_dir%/public/build'",
                        "    # If multiple builds are defined (as shown below), you can disable the default build:",
                        "    # output_path: false",
                        "",
                        "    # Set attributes that will be rendered on all script and link tags",
                        "    script_attributes:",
                        "        defer: true",
                        "        # Uncomment (also under link_attributes) if using Turbo Drive",
                        "        # https://turbo.hotwired.dev/handbook/drive#reloading-when-assets-change",
                        "        # 'data-turbo-track': reload",
                        "        # link_attributes:",
                        "        # Uncomment if using Turbo Drive",
                        "        # 'data-turbo-track': reload",
                        "",
                        "        # If using Encore.enableIntegrityHashes() and need the crossorigin attribute (default: false, or use 'anonymous' or 'use-credentials')",
                        "        # crossorigin: 'anonymous'",
                        "",
                        "        # Preload all rendered script and link tags automatically via the HTTP/2 Link header",
                        "        # preload: true",
                        "",
                        "        # Throw an exception if the entrypoints.json file is missing or an entry is missing from the data",
                        "        # strict_mode: false",
                        "",
                        "        # If you have multiple builds:",
                        "        # builds:",
                        "        # frontend: '%kernel.project_dir%/public/frontend/build'",
                        "",
                        "        # pass the build name as the 3rd argument to the Twig functions",
                        "        # {{ encore_entry_script_tags('entry1', null, 'frontend') }}",
                        "",
                        "framework:",
                        "    assets:",
                        "        json_manifest_path: '%kernel.project_dir%/public/build/manifest.json'",
                        "",
                        "when@dev:",
                        "    webpack_encore:",
                        "        output_path: '%kernel.project_dir%/public/webpack-dev/build'",
                        "    framework:",
                        "        assets:",
                        "            json_manifest_path: '%kernel.project_dir%/public/webpack-dev/build/manifest.json'",
                        "",
                        "#when@prod:",
                        "#    webpack_encore:",
                        "#        # Cache the entrypoints.json (rebuild Symfony's cache when entrypoints.json changes)",
                        "#        # Available in version 1.2",
                        "#        cache: true",
                        "",
                        "#when@test:",
                        "#    webpack_encore:",
                        "#        strict_mode: false",
                        ""
                    ],
                    "executable": false
                },
                "docker/build-resources": {
                    "contents": [
                        "#!/usr/bin/env bash",
                        "",
                        "# Paths and configuration",
                        "BASEDIR=\"$(cd \"$(dirname \"$0\")/..\" && pwd)\"",
                        "DOT_ENV=$BASEDIR/.env",
                        "",
                        "docker run \\",
                        "  --user $(id -u):$(id -g) \\",
                        "  --workdir /var/www/app \\",
                        "  --env-file $DOT_ENV \\",
                        "  --env NPM_CONFIG_CACHE=/var/www/app/var/volumes/.npm \\",
                        "  --rm \\",
                        "  -v $BASEDIR/app:/var/www/app \\",
                        "  node:12 \\",
                        "  bash -c \"npm install; npm run build\"",
                        ""
                    ],
                    "executable": true
                },
                "docker/npm": {
                    "contents": [
                        "#!/usr/bin/env bash",
                        "",
                        "docker-compose exec webpack npm \"$@\""
                    ],
                    "executable": true
                },
                "package.json": {
                    "contents": [
                        "{",
                        "  \"devDependencies\": {",
                        "    \"@babel/core\": \"^7.17.0\",",
                        "    \"@babel/preset-env\": \"^7.16.0\",",
                        "    \"@symfony/webpack-encore\": \"^4.0.0\",",
                        "    \"core-js\": \"^3.23.0\",",
                        "    \"file-loader\": \"^6.2.0\",",
                        "    \"regenerator-runtime\": \"^0.13.9\",",
                        "    \"webpack-notifier\": \"^1.15.0\"",
                        "  },",
                        "  \"dependencies\": {",
                        "    \"@hotwired/stimulus\": \"^3.0.0\",",
                        "    \"@symfony/stimulus-bridge\": \"^3.2.0\"",
                        "  },",
                        "  \"license\": \"UNLICENSED\",",
                        "  \"private\": true,",
                        "  \"scripts\": {",
                        "    \"dev-server\": \"encore dev-server\",",
                        "    \"dev\": \"encore dev\",",
                        "    \"watch\": \"encore dev --watch\",",
                        "    \"build\": \"encore production --progress\",",
                        "    \"test\": \"jest --passWithNoTests\",",
                        "    \"eslint\": \"eslint ./assets --ext .js,.ts,.vue\",",
                        "    \"stylelint\": \"stylelint \\\"./assets/**/*.vue\\\" \\\"./assets/**/*.*css\\\"\",",
                        "    \"prettier\": \"prettier --config .prettierrc --write \\\"./assets/**/*.{vue,js,ts,json,md}\\\"\"",
                        "  },",
                        "  \"husky\": {",
                        "    \"hooks\": {",
                        "      \"pre-commit\": \"lint-staged\"",
                        "    }",
                        "  },",
                        "  \"lint-staged\": {",
                        "    \"(src|tests)/**/*.php\": [",
                        "      \"docker/phpunit\",",
                        "      \"docker/phpstan\"",
                        "    ],",
                        "    \"assets/**/*.{vue,js,ts}\": [",
                        "      \"npx eslint --cache --fix\",",
                        "      \"jest --findRelatedTests\"",
                        "    ]",
                        "  }",
                        "}",
                        ""
                    ],
                    "executable": false
                },
                "webpack.config.js": {
                    "contents": [
                        "const Encore = require('@symfony/webpack-encore');",
                        "",
                        "// Manually configure the runtime environment if not already configured yet by the \"encore\" command.",
                        "// It's useful when you use tools that rely on webpack.config.js file.",
                        "if (!Encore.isRuntimeEnvironmentConfigured()) {",
                        "    Encore.configureRuntimeEnvironment(process.env.NODE_ENV || 'dev');",
                        "}",
                        "",
                        "Encore",
                        "    .setOutputPath(Encore.isDev() ? 'public/webpack-dev/build' : 'public/build')",
                        "    .setPublicPath(Encore.isDev() ? '/webpack-dev/build' : '/build')",
                        "    .configureDevServerOptions((options) => {",
                        "        options.hot = true;",
                        "        options.host = '0.0.0.0';",
                        "        options.port = 443;",
                        "        options.allowedHosts = 'all'",
                        "    })",
                        "",
                        "    // only needed for CDN's or sub-directory deploy",
                        "    .setManifestKeyPrefix('build/')",
                        "",
                        "    /*",
                        "     * ENTRY CONFIG",
                        "     *",
                        "     * Each entry will result in one JavaScript file (e.g. app.js)",
                        "     * and one CSS file (e.g. app.css) if your JavaScript imports CSS.",
                        "     */",
                        "    .addEntry('app', './assets/app.js')",
                        "",
                        "    // enables the Symfony UX Stimulus bridge (used in assets/bootstrap.js)",
                        "    .enableStimulusBridge('./assets/controllers.json')",
                        "",
                        "    // When enabled, Webpack \"splits\" your files into smaller pieces for greater optimization.",
                        "    .splitEntryChunks()",
                        "",
                        "    // will require an extra script tag for runtime.js",
                        "    // but, you probably want this, unless you're building a single-page app",
                        "    .enableSingleRuntimeChunk()",
                        "",
                        "    .copyFiles([",
                        "        {",
                        "          from: './assets/images',",
                        "          to: 'images/[path][name].[hash:8].[ext]',",
                        "        },",
                        "        {",
                        "          from: './assets/favicon',",
                        "          to: 'images/favicon/[path][name].[ext]',",
                        "        }",
                        "    ])",
                        "",
                        "    /*",
                        "     * FEATURE CONFIG",
                        "     *",
                        "     * Enable & configure other features below. For a full",
                        "     * list of features, see:",
                        "     * https://symfony.com/doc/current/frontend.html#adding-more-features",
                        "     */",
                        "    .cleanupOutputBeforeBuild()",
                        "    .enableBuildNotifications()",
                        "    .enableSourceMaps(!Encore.isProduction())",
                        "    // enables hashed filenames (e.g. app.abc123.css)",
                        "    .enableVersioning(Encore.isProduction())",
                        "",
                        "    // configure Babel",
                        "    // .configureBabel((config) => {",
                        "    //     config.plugins.push('@babel/a-babel-plugin');",
                        "    // })",
                        "",
                        "    // enables and configure @babel/preset-env polyfills",
                        "    .configureBabelPresetEnv((config) => {",
                        "        config.useBuiltIns = 'usage';",
                        "        config.corejs = '3.23';",
                        "    })",
                        "",
                        "    // enables Sass/SCSS support",
                        "    //.enableSassLoader()",
                        "",
                        "    // uncomment if you use TypeScript",
                        "    //.enableTypeScriptLoader()",
                        "",
                        "    // uncomment if you use React",
                        "    //.enableReactPreset()",
                        "",
                        "    // uncomment to get integrity=\"...\" attributes on your script & link tags",
                        "    // requires WebpackEncoreBundle 1.4 or higher",
                        "    //.enableIntegrityHashes(Encore.isProduction())",
                        "",
                        "    // uncomment if you're having problems with a jQuery plugin",
                        "    //.autoProvidejQuery()",
                        ";",
                        "",
                        "if (Encore.isDev()) {",
                        "    // Disable CSS extraction in Dev, as HMR does not work properly with MiniCssExtractPlugin.",
                        "    Encore.disableCssExtraction();",
                        "}",
                        "",
                        "module.exports = Encore.getWebpackConfig();",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "4c97c15b254c1a47ecec1038f822860b8e3cae38"
        }
    }
}
