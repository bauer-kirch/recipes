{
    "manifests": {
        "doctrine/doctrine-bundle": {
            "manifest": {
                "bundles": {
                    "Doctrine\\Bundle\\DoctrineBundle\\DoctrineBundle": [
                        "all"
                    ]
                },
                "copy-from-recipe": {
                    "config/": "%CONFIG_DIR%/"
                },
                "env": {
                    "DATABASE_URL": "mysql://root:password@database:3306/app_${APP_ENV}?serverVersion=mariadb-10.8.0&charset=utf8"
                },
                "docker-compose": {
                    "docker-compose.yml": {
                        "services": [
                            "database:",
                            "  image: mariadb:${MARIADB_VERSION:-10.8}",
                            "  ports:",
                            "    - ${MARIADB_PORT:-3306}:3306",
                            "  environment:",
                            "    MARIADB_DATABASE: ${MARIADB_DATABASE:-app}",
                            "    MARIADB_PASSWORD: ${MARIADB_PASSWORD:-password}",
                            "    MARIADB_USER: ${MARIADB_USER:-user}",
                            "    MARIADB_ROOT_PASSWORD: ${MARIADB_ROOT_PASSWORD:-password}",
                            "  volumes:",
                            "    - db-data:/var/lib/mysql:rw",
                            "",
                            "adminer:",
                            "  image: adminer:latest",
                            "  ports:",
                            "    - ${ADMINER_PORT:-8080}:8080",
                            "  environment:",
                            "    ADMINER_DEFAULT_SERVER: database",
                            ""
                        ],
                        "volumes": [
                            "db-data:"
                        ]
                    }
                },
                "conflict": {
                    "symfony/framework-bundle": "<5.3"
                },
                "post-install-output": [
                    "  * Modify your DATABASE_URL config in <fg=green>.env</>",
                    "",
                    "  * Configure the <fg=green>driver</> (mysql) and",
                    "    <fg=green>server_version</> (mariadb-10.8) in <fg=green>config/packages/doctrine.yaml</>",
                    "",
                    "  * This recipe expects you to set up bounded contexts in src/, so no",
                    "    default \"Entity\" folder and default mapping have been created. After",
                    "    adding your bounded contexts, register ORM mappings in your",
                    "    <fg=green>config/packages/doctrine.yaml</> accordingly."
                ]
            },
            "files": {
                "config/packages/doctrine.yaml": {
                    "contents": [
                        "doctrine:",
                        "    dbal:",
                        "        url: '%env(resolve:DATABASE_URL)%'",
                        "",
                        "        # IMPORTANT: You MUST configure your server version,",
                        "        # either here or in the DATABASE_URL env var (see .env file)",
                        "        #server_version: 'mariadb-10.8'",
                        "    orm:",
                        "        auto_generate_proxy_classes: true",
                        "        naming_strategy: doctrine.orm.naming_strategy.underscore_number_aware",
                        "        auto_mapping: true",
                        "        mappings:",
                        "            # MyBoundedContext:",
                        "            #     is_bundle: false",
                        "            #     dir: '%kernel.project_dir%/src/MyBoundedContext/Entity'",
                        "            #     prefix: 'App\\MyBoundedContext\\Entity'",
                        "            #     alias: MyBoundedContext",
                        "",
                        "when@test:",
                        "    doctrine:",
                        "        dbal:",
                        "            # \"TEST_TOKEN\" is typically set by ParaTest",
                        "            dbname_suffix: '_test%env(default::TEST_TOKEN)%'",
                        "",
                        "when@prod:",
                        "    doctrine:",
                        "        orm:",
                        "            auto_generate_proxy_classes: false",
                        "            query_cache_driver:",
                        "                type: pool",
                        "                pool: doctrine.system_cache_pool",
                        "            result_cache_driver:",
                        "                type: pool",
                        "                pool: doctrine.result_cache_pool",
                        "",
                        "    framework:",
                        "        cache:",
                        "            pools:",
                        "                doctrine.result_cache_pool:",
                        "                    adapter: cache.app",
                        "                doctrine.system_cache_pool:",
                        "                    adapter: cache.system",
                        ""
                    ],
                    "executable": false
                }
            },
            "ref": "057e82cfc9de05cbe5bd6c8b9de117769ac8c164"
        }
    }
}
